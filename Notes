X_train_total = np.array(trainset.data)
Y_train_total = np.array(trainset.targets)
X_valid_total = np.array(testset.data)
Y_valid_total = np.array(testset.targets)


trainset.data = X_train
trainset.targets = map_Y_train

testset.data = X_valid_cumul
testset.targets = map_Y_valid_cumul

evalset.data = X_valid_cumul
evalset.targets = map_Y_valid_cumul

tg_model = train_model(trainloader, testloader, tg_model,ref_model,ckp_name,main_ckp_prefix,

herding
evalset.data = prototypes[iter_dico]
                evalset.targets = np.zeros(len(evalset.data)) #zero labels
                evalloader = torch.utils.data.DataLoader(evalset, batch_size=eval_batch_size,
                                                         shuffle=False, num_workers=2)
evalset.data = X_valid_cumul
evalset.targets = map_Y_valid_cumul

final eval
evalset.data = X_valid_ori
 evalset.targets = map_Y_valid_ori